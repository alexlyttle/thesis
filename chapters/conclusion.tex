% chapters/conclusion.tex
%
% Copyright 2022 Alexander Lyttle.
%
% This work may be distributed and/or modified under the conditions of the
% LaTeX Project Public License (LPPL) version 1.3 or later.
%
% The latest version of this license is in
% https://www.latex-project.org/lppl.txt and version 1.3 or later is part of
% all distributions of LaTeX version 2005/12/01 or later.
%
%
\chapter{Conclusion \& Future Prospects}

\textit{We conclude this thesis by providing a summary of the work herein and reflecting upon key results. Then, we consider possible improvements to our hierarchical model and method for emulating stellar simulations. Finally, we discuss future prospects for applying our method to data from current and upcoming missions.}

\section*{Summary}

In this thesis, we built a hierarchical Bayesian model (HBM) to improve the inference of stellar parameters with asteroseismology. Introducing the concept of an HBM in Chapter \ref{chap:hbm}, we showed how population-level distributions can be used as a prior over individual stellar parameters. We found that pooling parameters this way reduced their uncertainties by up to a factor of \(\sqrt{N}\) where \(N\) is the number of stars in the population.

In Chapter \ref{chap:hmd}, we built an HBM to estimate the masses, radii,and ages for a well-studied sample of \(\sim 60\) dwarf and subgiant solar-like oscillators. Limited by observational noise, existing modelling techniques typically struggle to account for the uncertainty in initial helium abundance (\(Y\)) and mixing-length theory parameter (\(\mlt\)) for these stars. We showed that applying a hierarchical prior over \(Y\) and \(\mlt\) allowed us to simultaneously marginalise over their uncertainty and model their distribution in the population. Pooling \(Y\) and \(\mlt\) in this way, we were still able to achieve statistical uncertainties of 1.2 per cent in radius, 2.5 per cent in mass, and 12 per cent in age. Notably, our HBM halved the uncertainty in stellar mass compared to the same model without parameter pooling. This provided a scalable and reproducible framework for modelling large populations of stars at the same time.

% In our HBM, we assumed a linear helium enrichment law as the mean of a population distribution over \(Y\). We marginalised over the uncertainty in the parameters of this law, improving upon other work which assume a fixed parametrisation of the law calibrated to the Sun \citep[e.g.][]{Serenelli.Johnson.ea2017}. We found the slope of this law (\(\Delta Y/\Delta Z\)) to be \(\approx 1\) and \(\approx 1.6\), with and without including the Sun-as-a-star in our population. Although these values of \(\Delta Y/\Delta Z\) were within 2-\(\sigma\) of each other and agreed with the literature, including the Sun had a clear effect on both \(Y\) and \(\mlt\). This offset may have been a result in our choice of \(\teff\) scale, suggesting an additional systematic we could add to the model. With some improvements to the HBM, we may be able to further break the degeneracy between \(\mlt\) and \(Y\).

The HBM required a function to map model parameters to observables. We built an emulator to approximate 1D numerical models of stellar evolution. Training a neural network on MESA stellar simulations, we were able to predict observable parameters (\(\teff, \dnu, L, [\mathrm{M/H}]\)) with typical precisions of less than \(\sim 0.1\) per cent (see Appendix \ref{apx:hmd}). This provided a simple, continuous and differentiable model well suited to modern, gradient-based MCMC algorithms. Another advantage to using a neural network emulator was its scalability. The simple matrix algebra involved is well suited to fast evaluations on a graphics processing unit (GPU) for large numbers of stars at the same time. Furthermore, the neural network could be scaled up to higher input and output dimensions with little performance impact, making the method transferable to other kinds of stars. For example, we recently trained a neural network to emulate the regularly spaced mode frequencies as a part of a Bayesian stellar model of \(\delta\) Scuti-type oscillators \citep{Scutt.Murphy.ea2023}.

In Chapter \ref{chap:glitch}, we recalled that glitches in stellar structure cause a periodic signal, \(\delta\nu\) in p mode frequencies. One such glitch arises from the second ionisation of helium, with the amplitude of \(\delta\nu_\helium\) correlating with helium abundance. Subsequently, we presented a new method for modelling the glitch signature using a Gaussian process (GP) in Chapter \ref{chap:glitch-gp}. Past methods for measuring the glitch in the mode frequencies (\(\nu_{nl}\)) used a polynomial in \(n\) to approximate the smooth functional form of the frequencies, over which the periodic glitch signature could be modelled \citep[e.g.][]{Mazumdar.Monteiro.ea2014,Verma.Raodeo.ea2019}. We replaced the polynomial with a GP characterised by a kernel describing our prior belief of the function's smoothness and flexibility. We applied this method to model the glitch signature in radial mode frequencies for a fake, Sun-like star and 16 Cyg A. The GP allowed us to marginalise over our uncertainty in the functional form of \(\nu_{n\,0}\) with \(n\). In comparison, we found that the polynomial method was too restrictive and unable to marginalise over uncertainty in the model.

% In Chapter \ref{chap:glitch}, we recalled that p mode frequencies carry information about acoustic glitches inside a star. However, the exact functional form of the modes with radial order is not known. We showed that a Gaussian Process (GP) could be employed to marginalise over the uncertainty in this functional form and improve detection of the helium glitch signature. Our method showed promise compared to those which have come before \citep[e.g.][]{Verma.Raodeo.ea2019}. We found the GP method was better able to find the true acoustic depth of He\,\textsc{ii} ionisation in our model star than the alternative, motivating a more quantitative comparison in the future. We hope to build a more informed prior on the model parameters and publish this method soon with more examples.

\section*{Improving the Hierarchical Model}

The helium glitch parameters for a given star correlate with its near-surface helium abundance. Therefore, a natural next step would be to include helium glitch parameters as an additional observable in our HBM. Our GP glitch model can be applied to both observed and modelled mode frequencies, providing extra parameters to include in our stellar model emulator. Adding these should improve inference of helium abundance for stars with individual modes identified \citep[e.g.][]{Davies.SilvaAguirre.ea2016,Lund.SilvaAguirre.ea2017}. Since our HBM simultaneously models the population distribution of helium, even a small number of stars with good helium constraint will in-turn improve helium estimates for the rest of the population. This introduces the possibility of testing more complex models of helium enrichment.

We also expect the HBM to scale to red giant solar-like oscillators for which observations are abundant. We trained the emulator on a grid of stellar models from the zero-age main sequence to the base of the red giant branch for masses from \SIrange{0.8}{1.2}{\solarmass}. The upper mass limit was motivated by the diminishing outer convective envelope (responsible for driving solar-like oscillators) in these stars on the main sequence. However, extending the emulator to model red giant solar-like oscillators would require expanding the grid up to \(\sim\SI{2.0}{\solarmass}\). We would need to compute thrice as many evolutionary tracks and evolve existing models further. Stars with \(M \gtrsim \SI{1.1}{\solarmass}\) have a convective core on the main sequence which introduces an additional model uncertainty from mixing at its boundary. Parametrising this process would further multiply the number of input tracks, increasing dimensionality and grid computation time. Therefore, we should research ways of selectively computing stellar models. For example, we could upsample the grid \citep[e.g.][]{Li.Davies.ea2022} where the neural network error is large.

There are a few additional systematic uncertainties we could also include in the HBM. For example, in Chapter \ref{chap:hmd} we did not consider the inaccuracies of near-surface physics which effect modelled mode frequencies. So-called `surface correction' methods exist \citep[e.g.][]{Ball.Gizon2014,Kjeldsen.Bedding.ea2008} but vary across the HR diagram when compared with 3D hydrodynamical simulations \citep{Sonoi.Samadi.ea2015}. \citet{Compton.Bedding.ea2018} found a range of surface corrections can shift modelled frequencies at \(\numax\) by up to \(\sim 0.5\) per cent. This would amount to a systematic effect on \(\dnu\) which we would expect to correlate with other stellar parameters. Therefore, a future iteration of the HBM should account for the surface term systematic.

\section*{Current and Future Data}

% The helium glitch parameters for a given star correlate with its near-surface helium abundance. Therefore, a natural next step would be to include helium glitch parameters in our HBM. Our GP glitch model can be applied to both observed and modelled mode frequencies, providing extra parameters to include in our stellar model emulator (see Section \ref{sec:conc-nn}). Including these should improve inference of helium abundance for stars with individual modes identified \citep[e.g.][]{Davies.SilvaAguirre.ea2016,Lund.SilvaAguirre.ea2017}. Since our HBM models the population distribution of helium, even a small number of stars with good helium constraint will in-turn improve helium estimates for the rest of the population. This introduces the possibility of testing more complex models of helium enrichment.

% We can also extend the hierarchical aspect of the model. There are other parameters which we expect to correlate in a population of stars. Binary star systems are likely to share common ages and chemical abundances. Some examples are 16 Cyg A and B with an age of \(\sim\SI{7}{\giga\year}\) \citep{Davies.Chaplin.ea2015,Metcalfe.Chaplin.ea2012}, and \(\alpha\) Cen A and B \citep{Kjeldsen.Bedding.ea2005,Bouchy.Carrier2002} with ages \(\sim\SI{6}{\giga\year}\) \citep{Bazot.Bourguignon.ea2012}. Since the masses of these systems are constrained independency of the models, they act as additional points of calibration within the model.

% There are a few additional systematic uncertainties we could also include in the HBM. In Chapter \ref{chap:hmd}, we did not consider the effect of uncertain atmospheric physics which effects the mode frequencies. Surface correction methods exist \citep[e.g.][]{Ball.Gizon2014,Kjeldsen.Bedding.ea2008} but vary across the HR diagram when compared with 3D hydrodynamical simulations \cite{Sonoi.Samadi.ea2015}. \citet{Compton.Bedding.ea2018} found a range of surface corrections can shift modelled frequencies at \(\numax\) by up to \(\sim 0.5\) per cent. This would amount to a systematic effect on \(\dnu\) which we would expect to correlate with other stellar parameters. Although \citet{Nsamba.Campante.ea2018} found the surface correction to have a small effect on inferred stellar parameters, when doing population inference this effect is likely to scale up. Therefore, a future iteration of the HBM should account for the surface term systematic.

% Once we extend the model to red giants, we can also consider including population distributions on stellar clusters. For example, \emph{Kepler} observed open clusters NGC... which all include solar-like oscillators \needcite. We can 

% \section{Emulating Stellar Models}\label{sec:conc-nn}

% We built an emulator which approximated 1D numerical models of stellar evolution to use in our HBM. Training a neural network on MESA stellar simulations, we could predict observables with typical precision of less than \(\sim 0.1\) per cent (see Appendix \ref{apx:hmd}). This provided a simple, continuous and differentiable model well suited to modern, gradient-based MCMC algorithms. We found one advantage to using a neural network emulator was its scalability. The linear algebra involved allowed for fast predictions for a large numbers of stars in parallel. Furthermore, the neural network can be scaled up to higher input and output dimensions with little performance impact, making the method transferable to other kinds of stars. For example, we recently trained a neural network to emulate the regularly spaced mode frequencies as a part of a Bayesian stellar model of \(\delta\) Scuti-type oscillators \citep{Scutt.Murphy.ea2023}.

% We also expect our emulation method to scale to red giant solar-like oscillators for which observations are abundant (see Section \ref{sec:conc-future}). We trained the emulator on a grid of stellar models from the zero-age main sequence to the base of the red giant branch for masses from \SIrange{0.8}{1.2}{\solarmass}. The upper mass limit was motivated by the diminishing outer convective envelope (responsible for driving solar-like oscillators) in these stars on the main sequence. However, extending the emulator to model red giant solar-like oscillators would require expanding the grid up to \(\sim\SI{2.0}{\solarmass}\). We would need to compute thrice as many evolutionary tracks and evolve existing models further. However, stars with \(M \gtrsim \SI{1.1}{\solarmass}\) have a convective core on the main sequence which introduces an additional model uncertainty from mixing at its boundary. Parametrising this would further multiply the number of input tracks. To handle more dimensions, we should research ways of selectively computing stellar models or augmenting the grid \citep[e.g.][]{Li.Davies.ea2022} where the neural network error is large.

% Currently, we compute a grid of models where inputs are spaced regularly. However, the neural network may perform better in some regions and worse in others. We could create an algorithm which computes more stellar evolutionary tracks in regions of parameter space where the neural network performs poorly. This way we could start with a sparse grid of training data, then generate more tracks where the neural network error is high and retrain.

% \section{Current and Future Data}\label{sec:conc-future}

We tested the HBM on stars observed by \emph{Kepler}, but there are a few current and upcoming missions which we can utilise to increase our sample size. With larger sample sizes, we can further increase the precision of pooled parameters and better characterise their spread in the population distribution. Recently, \citet{Hatt.Nielsen.ea2023} identified a sample of \(\sim 4000\) solar-like oscillators in 120- and 20-second cadence \emph{TESS} data. Of these, around 50 are dwarf and subgiant stars which we could include in a future iteration of the HBM. However, we anticipate much bigger improvement with future missions expected to launch in a few years time.

% This has been exceptionally useful with galactic archaology with the \(\sim 150,000\) oscillating red giants detected by \citet{Hon.Huber.ea2021}. 

Towards the end of the 2020s, the \emph{PLATO} mission will observe tens of thousands of dwarf and subgiant solar-like oscillators \citep{Rauer.Catala.ea2014}. \emph{PLATO} aims to discover hundreds of exoplanets orbiting solar-type stars across a wider proportion of the sky than observed by \emph{Kepler}. Among its targets are around \num{20000} bright (V < 11) oscillating F-K dwarf stars to be observed over a baseline of around 2 years \citep{Goupil2017}. Using our HBM method on a sample this size could see a reduction in uncertainty (\(\sigma\)) on helium abundance from 0.01 to 0.0005. While this is the maximum expected uncertainty reduction (as discussed in Chapter \ref{chap:hbm}), it shows that we can start to consider more complex population distributions in helium and other stellar parameters.

While \emph{PLATO} will offer unprecedented numbers of main sequence solar-like oscillators, we already have large samples of more evolved asteroseismic stars to include in a future HBM. Combined, \emph{Kepler}, \emph{K2}, and \emph{TESS} have yielded \(\sim 150,000\) red giant solar-like oscillators to date \citep{Hon.Huber.ea2021,Yu.Huber.ea2018}. Providing that we can extend our stellar model emulator to more these stars, expanding our dataset will allow us to test more complex population-distributions. For example, since \emph{TESS} is an all-sky survey, we could include kinematics and galactic positions in the helium enrichment law. Additionally, observations of open clusters and binary star systems introduce more population distributions over age, distance and chemical abundances.

% The number of dwarf and subgiant solar-like oscillators expected from \emph{PLATO} will be comparable to the number of red giant oscillators already found with \emph{Kepler} and \emph{TESS} \needcite. In the meantime we could test extending our method to red giant stars to make use of the abundance of data. This comes with additional challenges. Oscillating red giants include masses \(\gtrsim \SI{1.2}{\solarmass}\) which would have had a convective core during their hydrogen-burning phase of evolution. In this case, we would have to consider overshooting at the convective core boundary. This is an approximation of the physics to simulate mixing at the boundary bringing fresh hydrogen fuel into the core and extending the main sequence lifetime.

% How about extending model to large number of red giants? Need to include other parameters like overshoot. Mode amplitude larger for these brighter targets, making solar-like oscillator datasets sizes much larger (e.g. 10,000s with Kepler)

Extending our HBM to red giants may be particularly worthwhile with the upcoming \emph{Nancy Grace Roman Space Telescope} \citep[\emph{Roman}, formerly \emph{WFIRST};][]{Spergel.Gehrels.ea2015}. Although asteroseismology is not its main focus, \emph{Roman} will observe the galactic bulge for a few years to search for free-floating planets with micro-lensing. Its light curves will be noisier than \emph{Kepler} and oscillation amplitudes are lower in infrared light, but \citet{Gould.Huber.ea2015} still predict a yield of \(\sim 10^6\) red giant oscillators. With these huge asteroseismic datasets expected in the next 10 years, it has never been a better time to research scalable methods for modelling populations of stars.

% Long-term, the recently proposed \emph{HAYDN} mission would be a dedicated asteroseismology mission looking at dense stellar clusters \citep{Miglio.Girardi.ea2021}. Also the Earth 2.0 mission to look at Earth-mass planets around solar-type stars \citep{Ge.Zhang.ea2022}. Looking at the \emph{Kepler} field for \SIrange{4}{8}{\year}. Estimates of 100,000 dwarf and subgiant oscillators. Lots of scope for HBMs here.
